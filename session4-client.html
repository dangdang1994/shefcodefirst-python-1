<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title> CFG session 4</title>

		<link rel="stylesheet" href="reveal.js/css/reveal.css">
		<link rel="stylesheet" href="reveal.js/css/theme/white.css">
		<!-- or you can use the dark theme
		rel="stylesheet" href="reveal.js/css/theme/black.css"> -->

		<!-- Customised theme  -->
		<link rel="stylesheet" href="reveal.js/css/theme/custom.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="reveal.js/lib/css/github-gist.css">

		<!-- Font awesome -->
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css" rel="stylesheet" media="all">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<style>
			.gist {transform: scale(0.9) translateY(-8%);}
			#req-url {position: absolute;top: 10px;left: 40%;font-size: 20px;color: #8E24AA;}
			#res {position: absolute;color: #8E24AA;font-size: 18px;bottom: 38%;left: 42.5%;}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides logo">
				<section>
					<h2> Session 4: Flask - using Python & HTML
						<span style="margin-left: 10px">together</span> (Part 2)
					</h2>
					<p>Linking together the back-end with the front-end</p>
					<p class='author'> Darren Vong
					<br>
				 <a href="http://twitter.com/mrdarrenv" target="_blank">
					<i class="fa fa-twitter" aria-hidden="true">
					</i> @mrdarrenv
				 </a>
 		 			</p>
				</section>

				<section>
					<h2> Where can I find the material? </h2>
					You can find all the slides, links to the curriculum, and
					to the GitHub repository at:
					<br>
					<br>
					<p class='fragment grow'>
						<a href="https://darrenvong.github.io/shefcodefirst-python/">
							https://darrenvong.github.io/shefcodefirst-python/</a></p>
				</section>

				<section>
					<h3><i class="fa fa-reply" aria-hidden="true"></i>
						Recap: Facebook Flask Challenge <i class="fa fa-flask" aria-hidden="true"></i>
					</h3>
				</section>

				<section>
					<script src="https://gist.github.com/darrenvong/7a14fb6012c9c5412fdbc47c2af68584.js"></script>
				</section>

				<section>
					<p>
						The <strong>two bugs</strong> in the application highlight some commonly
						made mistakes:
					</p>
					<p class="fragment">
						<i class="fa fa-times" aria-hidden="true" style="color:#ef3a34;"></i>
						1. Be careful not to name your Python file <strong>flask.py</strong>, or
						for future references, any name that's identical to the library you are
						going to import, as your copy of the code will <em><strong>hide</strong></em>
						the actual flask library you want to import!
					</p>
				</section>

				<section>
					<p>
						<i class="fa fa-times" aria-hidden="true" style="color:#ef3a34;"></i>
						2. The <strong><em>app.run(debug=True)</em></strong> line is
						<strong>wrongly indented</strong>: unlike other languages which
						mark a block of code with some form of brackets, Python relies on the
						<strong>indentations</strong> to do the same job, so pay attention to
						them in your code!
					</p>
				</section>

				<section>
					<h3> <i class="fa fa-reply" aria-hidden="true"></i>
						Recap: What happens when we visit a web page?
					</h3>
				</section>

				<section>
					<figure style="position: relative;">
						<img src="assets/req_res_cycle.png" alt="The Request-Response Cycle">
						<strong>
							<p id="req-url">https://pawlean.com</p>
						</strong>
						<div id="res">
							<strong>
								<p style="margin:0;">&lt;!DOCTYPE html&gt;</p>
							</strong>
							<strong>
								<p style="margin:0;">&lt;html&gt;...&lt;/html&gt;</p>
							</strong>
						</div>
					</figure>
				</section>

				<section>
					<ul>
						<li>
							Typing in the URL of the page sends <strong>a request</strong> to the server
							running the website.
						</li>
						<li>
							Using the information in the request with the URL, the server generates the
							right HTML page as <strong>a response</strong> back to our browser.
						</li>
						<li>
							Our browser processes the HTML response, along with any included CSS and
							JavaScript, then renders it out nicely for us to see in our browser.
						</li>
					</ul>
				</section>

				<section>
					<h3><i class="fa fa-reply" aria-hidden="true"></i>
						Recap: Flask <i class="fa fa-flask" aria-hidden="true"></i>
					</h3>
				</section>

				<section>
					<p>
						<strong>A framework</strong> containing code written by somebody else
						which deals with the complexity of handling <strong>requests</strong> &
						<strong>responses</strong>, so we can focus on writing the interesting part of
						our application.
					</p>
				</section>

				<section>
					<p>
						Before returning the HTML, Flask runs it through a
						<strong>template engine</strong>
						which generates most of the HTML
						<strong>dynamically</strong> before returning it as a response to our browser.
					</p>
				</section>

				<section>
					<h3>
						<i class="fa fa-reply" aria-hidden="true"></i>
						Recap: Routing
					</h3>
					<p>
						Not explicitly mentioned in the last session, but the <strong>app.route(...)</strong>
						"magic function" <strong>binds</strong> the URL specified to the standard Python
						function which will then handle the <strong>requests</strong> from users.
					</p>
					<p class="fragment">
						Flask uses <strong>relative URLs</strong> - this is usually the string after the
						first single slash.
					</p>
				</section>

				<section>
					<h3>
						<i class="fa fa-reply" aria-hidden="true"></i>
						Recap: Routing (cont.)
					</h3>
					<p>
						Relative URLs are used so that our application <strong>works in a consistent way</strong>,
						regardless of where we host it.
					</p>
					<p class="fragment">
						In our case where we have been developing locally, <strong>/hello</strong> is
						a relative URL with respect to the host <strong>localhost:5000</strong>, and so
						can be accessed by visiting <strong>localhost:5000/hello</strong>
					</p>
				</section>

				<section>
					<h3>And now...</h3>
				</section>

				<section>
					<h3><i class="fa fa-lightbulb-o" aria-hidden="true"></i>
						What is a template engine? Why do we use it?
					</h3>
					<p>
						To understand why we write HTML templates and use a
						template engine to process them, we need to take a quick look
						at how web pages were made <strong>before template engines existed</strong>.
					</p>
				</section>

				<section>
					<p>
						Without templates, web pages have to be served as <strong>static HTML files</strong>
						when the user visits the page. These have to be written up <strong>in full</strong>
						before a user visit our site.
					</p>
					<p class="fragment">
						This is essentially what you did if you completed the Beginners course!
					</p>
					<p class="fragment">Revisiting a familiar diagram might make this clearer...</p>
				</section>

				<section>
					<figure style="position: relative;">
						<img src="assets/req_res_cycle.png" alt="The Request-Response Cycle">
						<strong>
							<p id="req-url">https://pawlean.com</p>
						</strong>
						<div id="res">
							<strong>
								<p style="margin:0;">&lt;!DOCTYPE html&gt;</p>
							</strong>
							<strong>
								<p style="margin:0;">&lt;html&gt;...&lt;/html&gt;</p>
							</strong>
						</div>
					</figure>
				</section>

				<section>
					<h3>
						Problems with static HTML <span style="margin-left:10px;">pages</span>...
					</h3>
					<p>
						It gets <strong>tedious</strong> as we'd have to write the HTML for
						each page we intend our users to visit <strong>from scratch</strong>
						(or lots of copy and pasting of common parts), even though there are only
						small differences between pages. 
					</p>
					<p class="fragment">Repetition of code is (generally) a bad idea.</p>
				</section>

				<section>
					<h3>
						Problems with static HTML <span style="margin-left:10px;">pages</span>... (cont.)
					</h3>
					<p>
						Writing the HTML ahead of the user's visit for <strong>dynamic pages</strong>
						becomes tricky when we only know how to lay out & style the page, but we
						<strong>don't know what the content looks like</strong> until they visit the page.
					</p>
				</section>
				
				<section>
					<p>
						Facebook and Twitter are great examples: the feed is different for everyone visiting,
						as it <strong>depends on many variable factors</strong> such as who they follow/are friends with.
					</p>
				</section>
				<section>
					<h3>Solution: write and use HTML <span style="margin-left:10px;">templates!</span></h3>
				</section>
				
				<section>
					<h3>How do templates solve our problems?</h3>
					<p>
						When writing templates, we only need to write in the HTML parts that
						<strong>we know for definite</strong>.
					</p>
					<p class="fragment">
						For parts we don't know, the HTML is generated with some logics using
						Python-like code with data from a user's <strong>request</strong> when they
						visit our website.
					</p>
					<p class="fragment">Let's see how we can do this in <strong>Flask</strong>!</p>
				</section>

				<section>
					<h3>
						<i class="fa fa-cogs" aria-hidden="true"></i>
						Hands on: a Flask program using templates
					</h3>
				</section>

				<section>
					<h3>More about requests...</h3>
					<p>
						Hopefully by now, you'd have noticed that the word <strong>request</strong>
						has been mentioned repeatedly.
					</p>
					<p class="fragment">
						There's just <strong>one more</strong> little detail that we need to
						understand about <strong>requests</strong> before we can move forward... the
						<strong>request type</strong>!
					</p>
				</section>

				<section>
					<h3>More about requests...</h3>
					<p>Earlier, we said:</p>
					<p class="fragment">
						"Typing in the URL of the page sends <strong>a request</strong> to the server
						running the website."
					</p>
					<p class="fragment">
						In fact, to be more precise, we are actually sending a <strong>GET request</strong>
						to the server running the website.
					</p>
				</section>

				<section>
					<h3>The main problem with GET requests</h3>
					<p>
						If we want the user to send some extra data when they visit a page on our website,
						the data are visible at the end of the URL.
						This is all well and good <strong>if the data is not sensitive</strong>!
					</p>
					<p class="fragment">
						To solve this problem, browsers allows data to be sent using a different kind of request
						known as a <strong>POST request</strong>, which is only accessible on our server.
					</p>
				</section>

				<section>
					<h3>
						<i class="fa fa-cogs" aria-hidden="true"></i>
						Hands on: handling POST requests in our Flask program
					</h3>
				</section>
				
				<section>
					<h2>The end!</h2>
				</section>

			</div>
		</div>

		<script src="config.js"></script>
		<script src="reveal.js/lib/js/head.min.js"></script>
		<script src="reveal.js/js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
        multiplex: {
          // Example values. To generate your own, see the socket.io server instructions.
          secret: null, // Obtained from the socket.io server. Gives this (the master) control of the presentation
          id: CONFIG.id, // Obtained from socket.io server
          url: 'https://reveal-js-multiplex-ccjbegmaii.now.sh' // Location of socket.io server
        },

				dependencies: [
          { src: 'https://cdn.socket.io/socket.io-1.3.5.js', async: true },
          { src: 'reveal.js/plugin/multiplex/client.js', async: true },
					{ src: 'reveal.js/plugin/markdown/marked.js' },
					{ src: 'reveal.js/plugin/markdown/markdown.js' },
					{ src: 'reveal.js/plugin/notes/notes.js', async: true },
					{ src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
